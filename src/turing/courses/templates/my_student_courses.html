{% extends "student_base.html" %}
{% load static %}

{% block content %}

<div class="content">
    <div class="container">
        <div class="welcome">
            <div class="welcome-head place-back">
                <button type="button" class="btn-back js-back" aria-label="Volver atrás">
                    <i class="fa-solid fa-chevron-left"></i>
                </button>
                <h1>Bienvenido, {{ user.name }}</h1>
            </div>
            <p class="welcome-sub">Gestiona tus materias y únete a nuevas clases desde aquí</p>
        </div>

        <div class="kpis">
            <div class="kpi card">
                <div class="icon"><i class="fa-solid fa-book-open"></i></div>
                <div>
                    <div class="label">Materias inscritas</div>
                    <div class="value">{{ courses|length }}</div>
                </div>
            </div>
            <div class="kpi card">
                <div class="icon"><i class="fa-solid fa-compass"></i></div>
                <div>
                    <div class="label">Disponibles para unirse</div>
                    <div class="value">{{ other_courses|length }}</div>
                </div>
            </div>
        </div>

        <div class="header-row">
            <h2>Mis Materias</h2>
        </div>

        <div class="courses-grid">
            {% for c in courses %}
            <article class="course-card card">
                <div class="card-header">
                    <h3>{{ c.name }}</h3>
                    <button class="icon-button" type="button" title="Opciones">
                        <i class="fa-solid fa-ellipsis"></i>
                    </button>
                </div>
                <div class="course-meta muted">Semestre: {{ c.level }}</div>
                {% if c.schedule %}<div class="course-meta muted">{{ c.schedule }}</div>{% endif %}
                <div class="course-actions">
                    <a href="{% url 'courses:student_course_detail' c.pk %}" class="btn btn-secondary">Ver detalles</a>
                    <a href="{% url 'chatbot:course_chat' c.id %}" class="btn btn-primary">Abrir chat</a>
                    <a href="{% url 'courses:student_leave' c.id %}" class="btn btn-danger-soft">Salir</a>
                </div>
            </article>
            {% empty %}
            <p>No estás inscrito en ninguna materia.</p>
            {% endfor %}
        </div>

        <div class="header-row" style="margin-top:18px">
            <h2>Explora y únete a nuevas materias</h2>
        </div>

        <div class="courses-grid">
            {% for c in other_courses %}
            <article class="course-card card">
                <div class="card-header">
                    <h3>{{ c.name }}</h3>
                    <button class="icon-button" type="button" title="Opciones">
                        <i class="fa-solid fa-ellipsis"></i>
                    </button>
                </div>
                <div class="course-meta muted">Nivel: {{ c.level }}</div>
                {% if c.schedule %}<div class="course-meta muted">{{ c.schedule }}</div>{% endif %}
                <div class="course-actions">
                    <a href="{% url 'courses:student_course_detail' c.pk %}" class="btn btn-outline">Ver detalles</a>
                    <a href="{% url 'courses:student_join' c.id %}" class="btn btn-primary">
                        <i class="fa-solid fa-right-to-bracket"></i> Unirse
                    </a>
                </div>
            </article>
            {% empty %}
            <p>No hay materias disponibles por ahora.</p>
            {% endfor %}
        </div>

    </div>
</div>

{% endblock content %}